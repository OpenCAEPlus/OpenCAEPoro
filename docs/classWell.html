<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCAEPoro: Well Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCAEPoro<span id="projectnumber">&#160;0.1.0 Oct/15/2021</span>
   </div>
   <div id="projectbrief">OpenCAE for multicomponent porous media flow</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classWell-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Well Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="Well_8hpp_source.html">Well.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7e109c1f8cb0ee115b10a557d7928e5d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a7e109c1f8cb0ee115b10a557d7928e5d">WellState</a> () const</td></tr>
<tr class="memdesc:a7e109c1f8cb0ee115b10a557d7928e5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the state of the well, Open or Close.  <a href="classWell.html#a7e109c1f8cb0ee115b10a557d7928e5d">More...</a><br /></td></tr>
<tr class="separator:a7e109c1f8cb0ee115b10a557d7928e5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf196051a266a036aeafb34035cc80b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#adf196051a266a036aeafb34035cc80b9">WellType</a> () const</td></tr>
<tr class="memdesc:adf196051a266a036aeafb34035cc80b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the type of well, Inj or Prod.  <a href="classWell.html#adf196051a266a036aeafb34035cc80b9">More...</a><br /></td></tr>
<tr class="separator:adf196051a266a036aeafb34035cc80b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a7325e7ccce6aed4f469e06d598066d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a6a7325e7ccce6aed4f469e06d598066d">InputPerfo</a> (const <a class="el" href="classWellParam.html">WellParam</a> &amp;well)</td></tr>
<tr class="memdesc:a6a7325e7ccce6aed4f469e06d598066d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Input the param of perforations.  <a href="classWell.html#a6a7325e7ccce6aed4f469e06d598066d">More...</a><br /></td></tr>
<tr class="separator:a6a7325e7ccce6aed4f469e06d598066d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab883d41c3842854f9c2fb15919d9880b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#ab883d41c3842854f9c2fb15919d9880b">Setup</a> (const <a class="el" href="classGrid.html">Grid</a> &amp;myGrid, const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="memdesc:ab883d41c3842854f9c2fb15919d9880b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the well, it will be called when <a class="el" href="classGrid.html">Grid</a> and <a class="el" href="classBulk.html">Bulk</a> finish setupping.  <a href="classWell.html#ab883d41c3842854f9c2fb15919d9880b">More...</a><br /></td></tr>
<tr class="separator:ab883d41c3842854f9c2fb15919d9880b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e894e0c7d9960483db283add94d34f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a2e894e0c7d9960483db283add94d34f4">CalWI_Peaceman_Vertical</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="memdesc:a2e894e0c7d9960483db283add94d34f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">cal <a class="el" href="classWell.html">Well</a> Index with Peaceman model for vertical well.  <a href="classWell.html#a2e894e0c7d9960483db283add94d34f4">More...</a><br /></td></tr>
<tr class="separator:a2e894e0c7d9960483db283add94d34f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a137e72feecbbb28b5a70515a85f7db5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a137e72feecbbb28b5a70515a85f7db5d">Init</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="separator:a137e72feecbbb28b5a70515a85f7db5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a636823f28ad32f39e9f519815f7cec4f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a636823f28ad32f39e9f519815f7cec4f">CalCFL</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt) const</td></tr>
<tr class="memdesc:a636823f28ad32f39e9f519815f7cec4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the CFL number, only parts related to wells are considered.  <a href="classWell.html#a636823f28ad32f39e9f519815f7cec4f">More...</a><br /></td></tr>
<tr class="separator:a636823f28ad32f39e9f519815f7cec4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c5c54987ca460ab025504f014ce96e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a98c5c54987ca460ab025504f014ce96e">CaldG</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="separator:a98c5c54987ca460ab025504f014ce96e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4001451f9c2d30df21980af227cc411a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a4001451f9c2d30df21980af227cc411a">CalInjdG</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="memdesc:a4001451f9c2d30df21980af227cc411a"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate pressure difference between well and perforations for injection.  <a href="classWell.html#a4001451f9c2d30df21980af227cc411a">More...</a><br /></td></tr>
<tr class="separator:a4001451f9c2d30df21980af227cc411a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9694b4878637482973e4acd418f011d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a9694b4878637482973e4acd418f011d4">CalProddG</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="memdesc:a9694b4878637482973e4acd418f011d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate pressure difference between well and perforations for prodcution.  <a href="classWell.html#a9694b4878637482973e4acd418f011d4">More...</a><br /></td></tr>
<tr class="separator:a9694b4878637482973e4acd418f011d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf45c0fc2455e809a3505f327e1afcb7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#abf45c0fc2455e809a3505f327e1afcb7">SmoothdG</a> ()</td></tr>
<tr class="separator:abf45c0fc2455e809a3505f327e1afcb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a869e7fb570c02e1c9999576bcc12ba5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a869e7fb570c02e1c9999576bcc12ba5e">CalTrans</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="memdesc:a869e7fb570c02e1c9999576bcc12ba5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate transmissibility for each phase in perforations.  <a href="classWell.html#a869e7fb570c02e1c9999576bcc12ba5e">More...</a><br /></td></tr>
<tr class="separator:a869e7fb570c02e1c9999576bcc12ba5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a874b5ec76145d0c252c953d809c9de77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a874b5ec76145d0c252c953d809c9de77">CalFlux</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const bool flag=false)</td></tr>
<tr class="separator:a874b5ec76145d0c252c953d809c9de77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0654767d227788ef21edc111c4383710"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a0654767d227788ef21edc111c4383710">MassConserve</a> (<a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt) const</td></tr>
<tr class="memdesc:a0654767d227788ef21edc111c4383710"><td class="mdescLeft">&#160;</td><td class="mdescRight">update moles of components in those bulks who connects to the well.  <a href="classWell.html#a0654767d227788ef21edc111c4383710">More...</a><br /></td></tr>
<tr class="separator:a0654767d227788ef21edc111c4383710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b9eb3c86378e65b9bad809946d2f4f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#ae3b9eb3c86378e65b9bad809946d2f4f">CalInjRate_Blk</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="separator:ae3b9eb3c86378e65b9bad809946d2f4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d134cb63650ae6dc9ce0b00a370a796"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a9d134cb63650ae6dc9ce0b00a370a796">CalProdRate_Blk</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="separator:a9d134cb63650ae6dc9ce0b00a370a796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a83f4e4723d6bee71c9f9d16119dd35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a0a83f4e4723d6bee71c9f9d16119dd35">CalInjQi_Blk</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt)</td></tr>
<tr class="separator:a0a83f4e4723d6bee71c9f9d16119dd35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb6d978c3d4453d4a9170cce3a35b5ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#acb6d978c3d4453d4a9170cce3a35b5ca">CalProdQi_Blk</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt)</td></tr>
<tr class="separator:acb6d978c3d4453d4a9170cce3a35b5ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dcdd933eca7605282cc48f8a870eedb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a1dcdd933eca7605282cc48f8a870eedb">CheckOptMode</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="separator:a1dcdd933eca7605282cc48f8a870eedb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3db9d7cfc10dc04d587cf442f4cf3a92"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a3db9d7cfc10dc04d587cf442f4cf3a92"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classWell.html#a3db9d7cfc10dc04d587cf442f4cf3a92">AllocateMat</a> (<a class="el" href="classSolver.html">Solver</a>&lt; T &gt; &amp;mySolver) const</td></tr>
<tr class="memdesc:a3db9d7cfc10dc04d587cf442f4cf3a92"><td class="mdescLeft">&#160;</td><td class="mdescRight">allocate memory for matrix.  <a href="classWell.html#a3db9d7cfc10dc04d587cf442f4cf3a92">More...</a><br /></td></tr>
<tr class="separator:a3db9d7cfc10dc04d587cf442f4cf3a92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca4cd158d56cbd633a05ae327af30fa2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#aca4cd158d56cbd633a05ae327af30fa2">AssembleMat_INJ_IMPES</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, <a class="el" href="classSolver.html">Solver</a>&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;mySolver, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt) const</td></tr>
<tr class="memdesc:aca4cd158d56cbd633a05ae327af30fa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">assemble matrix, parts related to injection well are included.  <a href="classWell.html#aca4cd158d56cbd633a05ae327af30fa2">More...</a><br /></td></tr>
<tr class="separator:aca4cd158d56cbd633a05ae327af30fa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b64d3238910e4f792b6ea03c476db1b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a7b64d3238910e4f792b6ea03c476db1b">AssembleMat_PROD_BLK_IMPES</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk, <a class="el" href="classSolver.html">Solver</a>&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;mySolver, const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;dt) const</td></tr>
<tr class="separator:a7b64d3238910e4f792b6ea03c476db1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0da4ab9b101dd38ab921f991273719d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a0da4ab9b101dd38ab921f991273719d4">UpdatePerfP</a> ()</td></tr>
<tr class="memdesc:a0da4ab9b101dd38ab921f991273719d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">update pressure in <a class="el" href="classPerforation.html" title="Perforation describe the connections between wells and bulks.">Perforation</a> after well pressure updates.  <a href="classWell.html#a0da4ab9b101dd38ab921f991273719d4">More...</a><br /></td></tr>
<tr class="separator:a0da4ab9b101dd38ab921f991273719d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f1d44fd7586866a902cfc90e3538e8a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a2f1d44fd7586866a902cfc90e3538e8a">CheckP</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="memdesc:a2f1d44fd7586866a902cfc90e3538e8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if abnormal Pressure occurs.  <a href="classWell.html#a2f1d44fd7586866a902cfc90e3538e8a">More...</a><br /></td></tr>
<tr class="separator:a2f1d44fd7586866a902cfc90e3538e8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab166b401ceae3c2290de9eb5f85c2c51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#ab166b401ceae3c2290de9eb5f85c2c51">CheckCrossFlow</a> (const <a class="el" href="classBulk.html">Bulk</a> &amp;myBulk)</td></tr>
<tr class="memdesc:ab166b401ceae3c2290de9eb5f85c2c51"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if crossflow happens.  <a href="classWell.html#ab166b401ceae3c2290de9eb5f85c2c51">More...</a><br /></td></tr>
<tr class="separator:ab166b401ceae3c2290de9eb5f85c2c51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb515fe5c49dd0ef3ca54d97cd1cb56e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#adb515fe5c49dd0ef3ca54d97cd1cb56e">ShowPerfStatus</a> () const</td></tr>
<tr class="memdesc:adb515fe5c49dd0ef3ca54d97cd1cb56e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Display operation mode of well and state of perforations.  <a href="classWell.html#adb515fe5c49dd0ef3ca54d97cd1cb56e">More...</a><br /></td></tr>
<tr class="separator:adb515fe5c49dd0ef3ca54d97cd1cb56e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a00dd6dcb59ae0bb7520c7294ea5cc585"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWell.html#a00dd6dcb59ae0bb7520c7294ea5cc585">WellGroup</a></td></tr>
<tr class="separator:a00dd6dcb59ae0bb7520c7294ea5cc585"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p ><a class="el" href="classWell.html">Well</a> class defines well, and any operations referred to wells are in it. <a class="el" href="classWell.html">Well</a> connects to the bulks by perforations, which serve as source and sink. Due to practical difficulties in production, a good treatment for well is important, excellent treatment will make the flow rate in well more stable. </p>

<p class="definition">Definition at line <a class="el" href="Well_8hpp_source.html#l00072">72</a> of file <a class="el" href="Well_8hpp_source.html">Well.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a3db9d7cfc10dc04d587cf442f4cf3a92" name="a3db9d7cfc10dc04d587cf442f4cf3a92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3db9d7cfc10dc04d587cf442f4cf3a92">&#9670;&nbsp;</a></span>AllocateMat()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void Well::AllocateMat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSolver.html">Solver</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>mySolver</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>allocate memory for matrix. </p>

<p class="definition">Definition at line <a class="el" href="Well_8hpp_source.html#l00195">195</a> of file <a class="el" href="Well_8hpp_source.html">Well.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>{</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        mySolver.rowCapacity[perf[p].location]++;</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    }</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_a24bc11890ea853a38fd9d6b843633b1b"><div class="ttname"><a href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a></div><div class="ttdeci">unsigned int USI</div><div class="ttdoc">Unsigned integer.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00027">OCPConst.hpp:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aca4cd158d56cbd633a05ae327af30fa2" name="aca4cd158d56cbd633a05ae327af30fa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca4cd158d56cbd633a05ae327af30fa2">&#9670;&nbsp;</a></span>AssembleMat_INJ_IMPES()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::AssembleMat_INJ_IMPES </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSolver.html">Solver</a>&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mySolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>assemble matrix, parts related to injection well are included. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00237">237</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>{</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     nc  = myBulk.numCom;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> wId = mySolver.dim;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    <span class="comment">// important !</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    mySolver.dim++;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span> </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> k = perf[p].location;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span> </div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Vfi_zi = 0;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>            Vfi_zi += myBulk.vfi[k * nc + i] * opt.zi[i];</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        }</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> pvtnum = myBulk.PVTNUM[k];</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>        perf[p].xi =</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>            myBulk.flashCal[pvtnum]-&gt;XiPhase(myBulk.P[k], myBulk.T, &amp;opt.zi[0]);</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> valw = dt * perf[p].xi * perf[p].transj[0];</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw   = valw * dG[p];</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> valb = valw * Vfi_zi;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bb   = valb * dG[p];</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span> </div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        <span class="comment">// Bulk to Well</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>        <span class="comment">// diag</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ptr = mySolver.diagPtr[k];</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>        mySolver.val[k][ptr] += valb;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        <span class="comment">// off diag</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>        mySolver.colId[k].push_back(wId);</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        mySolver.val[k].push_back(-valb);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>        <span class="comment">// b</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>        mySolver.b[k] += bb;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>        <span class="comment">// Well to Bulk</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        <span class="keywordflow">switch</span> (opt.optMode) {</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>            <span class="keywordflow">case</span> RATE_MODE:</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>            <span class="keywordflow">case</span> ORATE_MODE:</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>            <span class="keywordflow">case</span> GRATE_MODE:</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>            <span class="keywordflow">case</span> WRATE_MODE:</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>            <span class="keywordflow">case</span> LRATE_MODE:</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>                <span class="comment">// diag</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>                mySolver.diagVal[wId] += valw;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>                <span class="comment">// off diag</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>                mySolver.colId[wId].push_back(k);</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>                mySolver.val[wId].push_back(-valw);</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>                <span class="comment">// b</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>                mySolver.b[wId] -= bw;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>            <span class="keywordflow">case</span> BHP_MODE:</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>                mySolver.colId[wId].push_back(k);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>                mySolver.val[wId].push_back(0);</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>                ERRORcheck(<span class="stringliteral">&quot;Wrong Well Opt mode&quot;</span>);</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>                exit(0);</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>        }</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    }</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>    <span class="comment">// Well Self</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>    assert(mySolver.val[wId].size() == numPerf);</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    <span class="comment">// the order of perforation is not necessarily in order</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    <span class="keywordflow">switch</span> (opt.optMode) {</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>        <span class="keywordflow">case</span> RATE_MODE:</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        <span class="keywordflow">case</span> ORATE_MODE:</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        <span class="keywordflow">case</span> GRATE_MODE:</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        <span class="keywordflow">case</span> WRATE_MODE:</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        <span class="keywordflow">case</span> LRATE_MODE:</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>            <span class="comment">// diag</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>            mySolver.colId[wId].push_back(wId);</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>            mySolver.diagPtr[wId] = numPerf;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>            mySolver.val[wId].push_back(mySolver.diagVal[wId]);</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>            <span class="comment">// b</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>            mySolver.b[wId] += dt * opt.maxRate;</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>        <span class="keywordflow">case</span> BHP_MODE:</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>            <span class="comment">// diag</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>            mySolver.colId[wId].push_back(wId);</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>            mySolver.diagPtr[wId] = numPerf;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>            mySolver.val[wId].push_back(dt);</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>            <span class="comment">// b</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>            mySolver.b[wId] += dt * opt.maxBHP;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>            <span class="comment">// u   initial value</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>            mySolver.u[wId] = opt.maxBHP;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>            ERRORcheck(<span class="stringliteral">&quot;Wrong Well Opt mode in function&quot;</span>);</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            exit(0);</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    }</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_a2c355586809161c6f4c3a35ebfa7cb1f"><div class="ttname"><a href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a></div><div class="ttdeci">double OCP_DBL</div><div class="ttdoc">Double precision.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00030">OCPConst.hpp:30</a></div></div>
<div class="ttc" id="aOCPConst_8hpp_html_a9951229752a2a6a4f40b81a78fad737b"><div class="ttname"><a href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a></div><div class="ttdeci">unsigned int OCP_USI</div><div class="ttdoc">Long unsigned integer.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00028">OCPConst.hpp:28</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7b64d3238910e4f792b6ea03c476db1b" name="a7b64d3238910e4f792b6ea03c476db1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b64d3238910e4f792b6ea03c476db1b">&#9670;&nbsp;</a></span>AssembleMat_PROD_BLK_IMPES()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::AssembleMat_PROD_BLK_IMPES </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSolver.html">Solver</a>&lt; <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mySolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >assemble matrix, parts related to production well are included. this function can only applied in Black Oil model now. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00329">329</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>{</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     np  = myBulk.numPhase;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     nc  = myBulk.numCom;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> wId = mySolver.dim;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <span class="comment">// important !</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    mySolver.dim++;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> k = perf[p].location;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> valb = 0;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bb   = 0;</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> valw = 0;</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> bw   = 0;</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>            <span class="keywordflow">if</span> (!myBulk.phaseExist[k * np + j]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tempb = 0;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tempw = 0;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span> </div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>                tempb += myBulk.vfi[k * nc + i] * myBulk.cij[k * np * nc + j * nc + i];</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>                tempw += opt.zi[i] * myBulk.cij[k * np * nc + j * nc + i];</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>            }</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> trans = dt * perf[p].transj[j] * myBulk.xi[k * np + j];</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>            valb += tempb * trans;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>            valw += tempw * trans;</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span> </div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dP = dG[p] - myBulk.Pc[k * np + j];</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>            bb += tempb * trans * dP;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>            bw += tempw * trans * dP;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        }</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span> </div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>        <span class="comment">// Bulk to Well</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>        <span class="comment">// diag</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> ptr = mySolver.diagPtr[k];</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        mySolver.val[k][ptr] += valb;</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>        <span class="comment">// off diag</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        mySolver.colId[k].push_back(wId);</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>        mySolver.val[k].push_back(-valb);</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>        <span class="comment">// b</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>        mySolver.b[k] += bb;</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span> </div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>        <span class="comment">// Well to Bulk</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>        <span class="keywordflow">switch</span> (opt.optMode) {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>            <span class="keywordflow">case</span> RATE_MODE:</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>            <span class="keywordflow">case</span> ORATE_MODE:</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>            <span class="keywordflow">case</span> GRATE_MODE:</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>            <span class="keywordflow">case</span> WRATE_MODE:</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>            <span class="keywordflow">case</span> LRATE_MODE:</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>                <span class="comment">// diag  !!! attention! sign is -</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>                mySolver.diagVal[wId] -= valw;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>                <span class="comment">// off diag</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>                mySolver.colId[wId].push_back(k);</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>                mySolver.val[wId].push_back(valw);</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>                <span class="comment">// b</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>                mySolver.b[wId] += bw;</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>            <span class="keywordflow">case</span> BHP_MODE:</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>                <span class="comment">// off diag</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>                mySolver.colId[wId].push_back(k);</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>                mySolver.val[wId].push_back(0);</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>                ERRORcheck(<span class="stringliteral">&quot;Wrong Well Opt mode&quot;</span>);</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>                exit(0);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        }</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    }</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    <span class="comment">// Well Self</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    assert(mySolver.val[wId].size() == numPerf);</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    <span class="comment">// the order of perforation is not necessarily in order</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    <span class="keywordflow">switch</span> (opt.optMode) {</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>        <span class="keywordflow">case</span> RATE_MODE:</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>        <span class="keywordflow">case</span> ORATE_MODE:</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>        <span class="keywordflow">case</span> GRATE_MODE:</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>        <span class="keywordflow">case</span> WRATE_MODE:</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>        <span class="keywordflow">case</span> LRATE_MODE:</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>            <span class="comment">// diag</span></div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>            mySolver.colId[wId].push_back(wId);</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>            mySolver.diagPtr[wId] = numPerf;</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>            mySolver.val[wId].push_back(mySolver.diagVal[wId]);</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>            <span class="comment">// b</span></div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>            mySolver.b[wId] += dt * opt.maxRate;</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>        <span class="keywordflow">case</span> BHP_MODE:</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>            <span class="comment">// diag</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>            mySolver.colId[wId].push_back(wId);</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>            mySolver.diagPtr[wId] = numPerf;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            mySolver.val[wId].push_back(dt);</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>            <span class="comment">// b</span></div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>            mySolver.b[wId] += dt * opt.minBHP;</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>            <span class="comment">// u   initial value</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>            mySolver.u[wId] = opt.minBHP;</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>            ERRORcheck(<span class="stringliteral">&quot;Wrong Well Opt mode&quot;</span>);</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>            exit(0);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    }</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a636823f28ad32f39e9f519815f7cec4f" name="a636823f28ad32f39e9f519815f7cec4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a636823f28ad32f39e9f519815f7cec4f">&#9670;&nbsp;</a></span>CalCFL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Well::CalCFL </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the CFL number, only parts related to wells are considered. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00178">178</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>{</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> cfl = 0;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> tmp = 0;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> k = perf[p].location;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>        tmp       = fabs(perf[p].qt_ft3) * dt;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>        tmp /= myBulk.rockVp[k];</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>        <span class="keywordflow">if</span> (cfl &lt; tmp) cfl = tmp;</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    }</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="keywordflow">return</span> cfl;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a98c5c54987ca460ab025504f014ce96e" name="a98c5c54987ca460ab025504f014ce96e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98c5c54987ca460ab025504f014ce96e">&#9670;&nbsp;</a></span>CaldG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::CaldG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >calculate pressure difference between well and perforations. it calculates pressure difference between perforations iteratively. this function can be used in both black oil model and compositional model. stability of this method shoule be tested. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00441">441</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>{</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="keywordflow">if</span> (opt.type == INJ)</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>        <a class="code hl_function" href="classWell.html#a4001451f9c2d30df21980af227cc411a">CalInjdG</a>(myBulk);</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>        <a class="code hl_function" href="classWell.html#a9694b4878637482973e4acd418f011d4">CalProddG</a>(myBulk);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>}</div>
<div class="ttc" id="aclassWell_html_a4001451f9c2d30df21980af227cc411a"><div class="ttname"><a href="classWell.html#a4001451f9c2d30df21980af227cc411a">Well::CalInjdG</a></div><div class="ttdeci">void CalInjdG(const Bulk &amp;myBulk)</div><div class="ttdoc">calculate pressure difference between well and perforations for injection.</div><div class="ttdef"><b>Definition:</b> <a href="Well_8cpp_source.html#l00449">Well.cpp:449</a></div></div>
<div class="ttc" id="aclassWell_html_a9694b4878637482973e4acd418f011d4"><div class="ttname"><a href="classWell.html#a9694b4878637482973e4acd418f011d4">Well::CalProddG</a></div><div class="ttdeci">void CalProddG(const Bulk &amp;myBulk)</div><div class="ttdoc">calculate pressure difference between well and perforations for prodcution.</div><div class="ttdef"><b>Definition:</b> <a href="Well_8cpp_source.html#l00513">Well.cpp:513</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a874b5ec76145d0c252c953d809c9de77" name="a874b5ec76145d0c252c953d809c9de77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a874b5ec76145d0c252c953d809c9de77">&#9670;&nbsp;</a></span>CalFlux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::CalFlux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>flag</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >calculate the flow rate of moles of components and total flow rate of volume in each perforations. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00678">678</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>{</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> np = myBulk.numPhase;</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nc = myBulk.numCom;</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span> </div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>    <span class="keywordflow">if</span> (opt.type == INJ) {</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>            perf[p].P  = BHP + dG[p];</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> k  = perf[p].location;</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dP = perf[p].P - myBulk.P[k];</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>            dP *= -1.0;</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span> </div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>            perf[p].qt_ft3 = perf[p].transj[0] * dP;</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span> </div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> pvtnum = myBulk.PVTNUM[k];</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>            <span class="keywordflow">if</span> (flag)</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>                perf[p].xi =</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>                    myBulk.flashCal[pvtnum]-&gt;XiPhase(myBulk.P[k], myBulk.T, &amp;opt.zi[0]);</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xi = perf[p].xi;</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>                perf[p].qi_lbmol[i] = perf[p].qt_ft3 * xi * opt.zi[i];</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>            }</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>        }</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span> </div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>            perf[p].P      = BHP + dG[p];</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> k      = perf[p].location;</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>            perf[p].qt_ft3 = 0;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>            perf[p].qi_lbmol.assign(nc, 0);</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span> </div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>                <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> <span class="keywordtype">id</span> = k * np + j;</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>                <span class="keywordflow">if</span> (myBulk.phaseExist[<span class="keywordtype">id</span>]) {</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>                    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dP = myBulk.Pj[id] - perf[p].P;</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>                    perf[p].qt_ft3 += perf[p].transj[j] * dP;</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>                    <span class="comment">// cout &lt;&lt; p &lt;&lt; &quot; p[&quot; &lt;&lt; j &lt;&lt; &quot;] = &quot; &lt;&lt; myBulk.Pj[id] &lt;&lt; endl;</span></div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>                    <span class="comment">// cout &lt;&lt; p &lt;&lt; &quot; perf = &quot; &lt;&lt; perf[p].p &lt;&lt; endl;</span></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span> </div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>                    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xi = myBulk.xi[id];</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>                    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xij;</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>                    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>                        xij = myBulk.cij[<span class="keywordtype">id</span> * nc + i];</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>                        perf[p].qi_lbmol[i] += perf[p].transj[j] * dP * xi * xij;</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>                    }</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>                }</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>            }</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>        }</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    }</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4001451f9c2d30df21980af227cc411a" name="a4001451f9c2d30df21980af227cc411a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4001451f9c2d30df21980af227cc411a">&#9670;&nbsp;</a></span>CalInjdG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::CalInjdG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate pressure difference between well and perforations for injection. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00449">449</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>{</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>         maxlen  = 10;</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>             seg_num = 0;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>         seg_len = 0;</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    vector&lt;OCP_DBL&gt; dGperf(numPerf, 0);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <span class="keywordflow">if</span> (depth &lt;= perf.front().depth) {</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        <span class="comment">// Well is higher</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a> p = numPerf - 1; p &gt;= 0; p--) {</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>            <span class="keywordflow">if</span> (p == 0) {</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>                seg_num = ceil((perf[0].depth - depth) / maxlen);</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>                seg_len = (perf[0].depth - depth) / seg_num;</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>                seg_num = ceil((perf[p].depth - perf[p - 1].depth) / maxlen);</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>                seg_len = (perf[p].depth - perf[p - 1].depth) / seg_num;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>            }</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n     = perf[p].location;</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>            perf[p].P     = BHP + dG[p];</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pperf = perf[p].P;</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Ptmp  = Pperf;</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span> </div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> pvtnum = myBulk.PVTNUM[n];</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; seg_num; i++) {</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>                Ptmp -=</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>                    myBulk.flashCal[pvtnum]-&gt;RhoPhase(Ptmp, myBulk.T, opt.zi.data()) *</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>                    GRAVITY_FACTOR * seg_len;</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>            }</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>            dGperf[p] = Pperf - Ptmp;</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        }</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        dG[0] = dGperf[0];</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 1; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>            dG[p] = dG[p - 1] + dGperf[p];</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>        }</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (depth &gt;= perf[numPerf - 1].depth) {</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>        <span class="comment">// Well is lower</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>            <span class="keywordflow">if</span> (p == numPerf - 1) {</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>                seg_num = ceil((depth - perf[numPerf - 1].depth) / maxlen);</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>                seg_len = (depth - perf[numPerf - 1].depth) / seg_num;</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>                seg_num = ceil((perf[p + 1].depth - perf[p].depth) / maxlen);</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>                seg_len = (perf[p + 1].depth - perf[p].depth) / seg_num;</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>            }</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n     = perf[p].location;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>            perf[p].P     = BHP + dG[p];</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pperf = perf[p].P;</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Ptmp  = Pperf;</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span> </div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> pvtnum = myBulk.PVTNUM[n];</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; seg_num; i++) {</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>                Ptmp +=</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>                    myBulk.flashCal[pvtnum]-&gt;RhoPhase(Ptmp, myBulk.T, opt.zi.data()) *</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>                    GRAVITY_FACTOR * seg_len;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>            }</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>            dGperf[p] = Ptmp - Pperf;</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>        }</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>        dG[numPerf - 1] = dGperf[numPerf - 1];</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a> p = numPerf - 2; p &gt;= 0; p--) {</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>            dG[p] = dG[p + 1] + dGperf[p];</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>        }</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>    }</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>}</div>
<div class="ttc" id="aOCPConst_8hpp_html_ae1557888748310c9f05f88c69bb30cc3"><div class="ttname"><a href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a></div><div class="ttdeci">int OCP_INT</div><div class="ttdoc">Long integer.</div><div class="ttdef"><b>Definition:</b> <a href="OCPConst_8hpp_source.html#l00029">OCPConst.hpp:29</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a83f4e4723d6bee71c9f9d16119dd35" name="a0a83f4e4723d6bee71c9f9d16119dd35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a83f4e4723d6bee71c9f9d16119dd35">&#9670;&nbsp;</a></span>CalInjQi_Blk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::CalInjQi_Blk </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >calculate flow rate of moles of components for injection well in black oil model. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00789">789</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>{</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     nc = myBulk.numCom;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> qj = 0;</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span> </div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span> </div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>        perf[p].P = BHP + dG[p];</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span> </div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>        <span class="comment">// OCP_USI k = perf[p].location;</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        <span class="comment">// OCP_DBL xi = perf[p].xi;</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>        <span class="comment">// OCP_DBL dP = perf[p].p - myBulk.p[k];</span></div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>        <span class="comment">// qj += perf[p].transj[0] * xi * dP;</span></div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span> </div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) qj += perf[p].qi_lbmol[i];</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    }</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>    <span class="keywordflow">if</span> (opt.fluidType == WATER) {</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>        WWIR = -qj;</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>        WWIT += WWIR * dt;</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>        WGIR = -qj;</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>        WGIT += WGIR * dt;</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>    }</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae3b9eb3c86378e65b9bad809946d2f4f" name="ae3b9eb3c86378e65b9bad809946d2f4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3b9eb3c86378e65b9bad809946d2f4f">&#9670;&nbsp;</a></span>CalInjRate_Blk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Well::CalInjRate_Blk </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >calculate flow rate of moles of components for injection well in black oil model, where pressure in injection well equals minial ones in injection well, which is input by users. this function is used to check if operation mode of well shoubld be swtched. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00742">742</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>{</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     np = myBulk.numPhase;</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     nc = myBulk.numCom;</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> qj = 0;</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span> </div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span> </div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pperf = opt.maxBHP + dG[p];</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> k     = perf[p].location;</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span> </div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     pvtnum = myBulk.PVTNUM[k];</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xi =</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>            myBulk.flashCal[pvtnum]-&gt;XiPhase(myBulk.P[k], myBulk.T, &amp;opt.zi[0]);</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dP = Pperf - myBulk.P[k];</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>        qj += perf[p].transj[0] * xi * dP;</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>    }</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>    <span class="keywordflow">return</span> qj;</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9694b4878637482973e4acd418f011d4" name="a9694b4878637482973e4acd418f011d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9694b4878637482973e4acd418f011d4">&#9670;&nbsp;</a></span>CalProddG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::CalProddG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate pressure difference between well and perforations for prodcution. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00513">513</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>{</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>             np      = myBulk.numPhase;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>             nc      = myBulk.numCom;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>         maxlen  = 10;</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>             seg_num = 0;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>         seg_len = 0;</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>    vector&lt;OCP_DBL&gt; tmpNi(nc, 0);</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>    vector&lt;OCP_DBL&gt; dGperf(numPerf, 0);</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>         qtacc  = 0;</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>         rhoacc = 0;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a>         rhotmp = 0;</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span> </div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>    <span class="keywordflow">if</span> (depth &lt;= perf.front().depth) {</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>        <span class="comment">// Well is higher</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span> </div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        <span class="comment">// check qi_lbmol   ----   test</span></div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        <span class="keywordflow">if</span> (perf[numPerf - 1].state == CLOSE) {</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a> p = numPerf - 2; p &gt;= 0; p--) {</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>                <span class="keywordflow">if</span> (perf[p].state == OPEN) {</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>                    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>                        perf[numPerf - 1].qi_lbmol[i] = perf[p].qi_lbmol[i];</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>                    }</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>                }</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>            }</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        }</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span> </div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a> p = numPerf - 1; p &gt;= 0; p--) {</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span> </div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>            <span class="keywordflow">if</span> (p == 0) {</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>                seg_num = ceil((perf[0].depth - depth) / maxlen);</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>                seg_len = (perf[0].depth - depth) / seg_num;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>                seg_num = ceil((perf[p].depth - perf[p - 1].depth) / maxlen);</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>                seg_len = (perf[p].depth - perf[p - 1].depth) / seg_num;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>            }</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span> </div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n     = perf[p].location;</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>            perf[p].P     = BHP + dG[p];</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pperf = perf[p].P;</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Ptmp  = Pperf;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span> </div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> pvtnum = myBulk.PVTNUM[n];</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>            tmpNi.assign(nc, 0);</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a> p1 = numPerf - 1; p1 &gt;= p; p1--) {</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>                    tmpNi[i] += perf[p1].qi_lbmol[i];</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>                }</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>            }</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; seg_num; k++) {</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>                myBulk.flashCal[pvtnum]-&gt;Flash_Ni(Ptmp, myBulk.T, tmpNi.data());</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; myBulk.numPhase; j++) {</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>                    <span class="keywordflow">if</span> (myBulk.flashCal[pvtnum]-&gt;phaseExist[j]) {</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>                        rhotmp = myBulk.flashCal[pvtnum]-&gt;rho[j];</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>                        qtacc += myBulk.flashCal[pvtnum]-&gt;v[j] / seg_num;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>                        rhoacc += myBulk.flashCal[pvtnum]-&gt;v[j] * rhotmp *</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>                                  GRAVITY_FACTOR / seg_num;</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>                    }</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>                }</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>                Ptmp -= rhoacc / qtacc * seg_len;</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>            }</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>            dGperf[p] = Pperf - Ptmp;</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        }</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        dG[0] = dGperf[0];</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 1; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>            dG[p] = dG[p - 1] + dGperf[p];</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        }</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (depth &gt;= perf.back().depth) {</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <span class="comment">// Well is lower</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        <span class="comment">// check qi_lbmol   ----   test</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>        <span class="keywordflow">if</span> (perf[0].state == CLOSE) {</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 1; p &lt;= numPerf; p++) {</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>                <span class="keywordflow">if</span> (perf[p].state == OPEN) {</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>                    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>                        perf[numPerf - 1].qi_lbmol[i] = perf[p].qi_lbmol[i];</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>                    }</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>                }</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>            }</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>        }</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span> </div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>            <span class="keywordflow">if</span> (p == numPerf - 1) {</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>                seg_num = ceil((depth - perf[numPerf - 1].depth) / maxlen);</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>                seg_len = (depth - perf[numPerf - 1].depth) / seg_num;</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>                seg_num = ceil((perf[p + 1].depth - perf[p].depth) / maxlen);</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>                seg_len = (perf[p + 1].depth - perf[p].depth) / seg_num;</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>            }</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span> </div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> n     = perf[p].location;</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>            perf[p].P     = BHP + dG[p];</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pperf = perf[p].P;</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Ptmp  = Pperf;</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> </div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> pvtnum = myBulk.PVTNUM[n];</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>            tmpNi.assign(nc, 0);</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a> p1 = numPerf - 1; p1 &gt;= p; p1--) {</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>                    tmpNi[i] += perf[p1].qi_lbmol[i];</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>                }</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>            }</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> k = 0; k &lt; seg_num; k++) {</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>                myBulk.flashCal[pvtnum]-&gt;Flash_Ni(Ptmp, myBulk.T, tmpNi.data());</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>                    <span class="keywordflow">if</span> (myBulk.flashCal[pvtnum]-&gt;phaseExist[j]) {</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>                        rhotmp = myBulk.flashCal[pvtnum]-&gt;rho[j];</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                        qtacc += myBulk.flashCal[pvtnum]-&gt;v[j] / seg_num;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>                        rhoacc += myBulk.flashCal[pvtnum]-&gt;v[j] * rhotmp *</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>                                  GRAVITY_FACTOR / seg_num;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>                    }</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>                }</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>                Ptmp += rhoacc / qtacc * seg_len;</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>            }</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>            dGperf[p] = Ptmp - Pperf;</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>        }</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>        dG[numPerf - 1] = dGperf[numPerf - 1];</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a> p = numPerf - 2; p &gt;= 0; p--) {</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>            dG[p] = dG[p + 1] + dGperf[p];</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>        }</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> </div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>        ERRORcheck(<span class="stringliteral">&quot;Wrong Well position&quot;</span>);</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        exit(0);</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>    }</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acb6d978c3d4453d4a9170cce3a35b5ca" name="acb6d978c3d4453d4a9170cce3a35b5ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb6d978c3d4453d4a9170cce3a35b5ca">&#9670;&nbsp;</a></span>CalProdQi_Blk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::CalProdQi_Blk </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >calculate flow rate of moles of components for production well in black oil model. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00814">814</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>{</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> np = myBulk.numPhase;</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nc = myBulk.numCom;</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span> </div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>    qi_lbmol.assign(nc, 0);</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span> </div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span> </div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>        <span class="comment">// perf[p].qi_lbmol.assign(nc, 0);</span></div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>        <span class="comment">// perf[p].p = BHP + dG[p];</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>        <span class="comment">// int k = perf[p].location;</span></div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span> </div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>        <span class="comment">// for (int j = 0; j &lt; np; j++) {</span></div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>        <span class="comment">//  int id = k * np + j;</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>        <span class="comment">//  if (myBulk.phaseExist[id]) {</span></div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>        <span class="comment">//      OCP_DBL xi = myBulk.xi[id];</span></div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>        <span class="comment">//      OCP_DBL dP = myBulk.Pj[id] - perf[p].p;</span></div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>        <span class="comment">//      OCP_DBL xij;</span></div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>        <span class="comment">//      for (int i = 0; i &lt; nc; i++) {</span></div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>        <span class="comment">//          xij = myBulk.cij[id * nc + i];</span></div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>        <span class="comment">//          perf[p].qi_lbmol[i] += perf[p].transj[j] * xi * xij * dP;</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>        <span class="comment">//      }</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>        <span class="comment">//  }</span></div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>        <span class="comment">//}</span></div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>            qi_lbmol[i] += perf[p].qi_lbmol[i];</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>        }</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>    }</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span> </div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>        <span class="keywordflow">if</span> (myBulk.phaseLabel[i] == OIL) {</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>            WOPR = qi_lbmol[i];</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>            WOPT += WOPR * dt;</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (myBulk.phaseLabel[i] == GAS) {</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>            WGPR = qi_lbmol[i];</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>            WGPT += WGPR * dt;</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (myBulk.phaseLabel[i] == WATER) {</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>            WWPR = qi_lbmol[i];</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>            WWPT += WWPR * dt;</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>        }</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>    }</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d134cb63650ae6dc9ce0b00a370a796" name="a9d134cb63650ae6dc9ce0b00a370a796"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d134cb63650ae6dc9ce0b00a370a796">&#9670;&nbsp;</a></span>CalProdRate_Blk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Well::CalProdRate_Blk </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >calculate flow rate of moles of components for production well in black oil model, where pressure in production well equals minial ones in production well, which is input by users. this function is used to check if operation mode of well shoubld be swtched. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00762">762</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>{</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     np = myBulk.numPhase;</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a>     nc = myBulk.numCom;</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> qj = 0;</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span> </div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span> </div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> Pperf = opt.minBHP + dG[p];</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> k     = perf[p].location;</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span> </div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> <span class="keywordtype">id</span> = k * np + j;</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>            <span class="keywordflow">if</span> (myBulk.phaseExist[<span class="keywordtype">id</span>]) {</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>                <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> temp = 0;</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>                    temp += opt.zi[i] * myBulk.cij[<span class="keywordtype">id</span> * nc + i];</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>                }</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>                <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> xi = myBulk.xi[id];</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>                <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dP = myBulk.Pj[id] - Pperf;</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>                qj += perf[p].transj[j] * xi * dP * temp;</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>            }</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>        }</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>    }</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>    <span class="keywordflow">return</span> qj;</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a869e7fb570c02e1c9999576bcc12ba5e" name="a869e7fb570c02e1c9999576bcc12ba5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a869e7fb570c02e1c9999576bcc12ba5e">&#9670;&nbsp;</a></span>CalTrans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::CalTrans </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate transmissibility for each phase in perforations. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00642">642</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>{</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> np = myBulk.numPhase;</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span> </div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>    <span class="keywordflow">if</span> (opt.type == INJ) {</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>            perf[p].transj.assign(np, 0);</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> k    = perf[p].location;</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> temp = CONV1 * CONV2 * perf[p].WI * perf[p].multiplier;</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span> </div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>            <span class="comment">// single phase</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>                <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> <span class="keywordtype">id</span> = k * np + j;</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>                <span class="keywordflow">if</span> (myBulk.phaseExist[<span class="keywordtype">id</span>]) {</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>                    perf[p].transj[0] += myBulk.kr[id] / myBulk.mu[id];</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>                }</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>            }</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>            perf[p].transj[0] *= temp;</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        }</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>            perf[p].transj.assign(np, 0);</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> k    = perf[p].location;</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> temp = CONV1 * CONV2 * perf[p].WI * perf[p].multiplier;</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span> </div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>            <span class="comment">// multi phase</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> j = 0; j &lt; np; j++) {</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>                <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> <span class="keywordtype">id</span> = k * np + j;</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>                <span class="keywordflow">if</span> (myBulk.phaseExist[<span class="keywordtype">id</span>]) {</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>                    perf[p].transj[j] = temp * myBulk.kr[id] / myBulk.mu[id];</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>                }</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>            }</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>        }</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>    }</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e894e0c7d9960483db283add94d34f4" name="a2e894e0c7d9960483db283add94d34f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e894e0c7d9960483db283add94d34f4">&#9670;&nbsp;</a></span>CalWI_Peaceman_Vertical()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::CalWI_Peaceman_Vertical </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>cal <a class="el" href="classWell.html">Well</a> Index with Peaceman model for vertical well. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00191">191</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>{</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <span class="comment">// this fomular needs to be carefully checked !</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="comment">// especially the dz</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>        <span class="keywordflow">if</span> (perf[p].WI &gt; 0) {</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> Idb = perf[p].location;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dx  = myBulk.dx[Idb];</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dy  = myBulk.dy[Idb];</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> dz  = myBulk.dz[Idb] * myBulk.ntg[Idb];</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>            <span class="keywordflow">switch</span> (perf[p].direction) {</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>                <span class="keywordflow">case</span> X_DIRECTION:</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>                <span class="keywordflow">case</span> Y_DIRECTION:</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>                <span class="keywordflow">case</span> Z_DIRECTION: {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>                    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> kxky  = myBulk.rockKx[Idb] * myBulk.rockKy[Idb];</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>                    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> kx_ky = myBulk.rockKx[Idb] / myBulk.rockKy[Idb];</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>                    assert(kx_ky &gt; 0);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>                    <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> ro =</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>                        0.28 *</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>                        pow((dx * dx * pow(1 / kx_ky, 0.5) + dy * dy * pow(kx_ky, 0.5)),</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>                            0.5);</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>                    ro /= (pow(kx_ky, 0.25) + pow(1 / kx_ky, 0.25));</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>                    <span class="keywordflow">if</span> (perf[p].kh &lt; 0) {</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>                        perf[p].WI = (2 * PI) * (dz * pow(kxky, 0.5)) /</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>                                     (log(ro / perf[p].radius) + perf[p].skinFactor);</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>                        perf[p].WI = (2 * PI) * perf[p].kh /</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>                                     (log(ro / perf[p].radius) + perf[p].skinFactor);</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>                    }</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>                }</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>                <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>                    ERRORcheck(<span class="stringliteral">&quot;Wrong direction of perforations!&quot;</span>);</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>                    exit(0);</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>            }</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        }</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    }</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab166b401ceae3c2290de9eb5f85c2c51" name="ab166b401ceae3c2290de9eb5f85c2c51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab166b401ceae3c2290de9eb5f85c2c51">&#9670;&nbsp;</a></span>CheckCrossFlow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a> Well::CheckCrossFlow </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check if crossflow happens. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00910">910</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>{</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> k;</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>    <span class="keywordtype">bool</span>    flagC = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span> </div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>    <span class="keywordflow">if</span> (opt.type == PROD) {</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> np = myBulk.numPhase;</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>            k            = perf[p].location;</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>            <a class="code hl_typedef" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> minP = myBulk.P[k];</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>            <span class="comment">// THINK MORE !!!</span></div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>            <span class="comment">// for (USI j = 0; j &lt; np; j++) {</span></div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>            <span class="comment">//  if (myBulk.phaseExist[k * np + j])</span></div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>            <span class="comment">//      minP = minP &lt; myBulk.Pj[k * np + j] ? minP : myBulk.Pj[k * np + j];</span></div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>            <span class="comment">//}</span></div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>            <span class="keywordflow">if</span> (perf[p].state == OPEN &amp;&amp; minP &lt; perf[p].P) {</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>                perf[p].state      = CLOSE;</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>                perf[p].multiplier = 0;</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>                flagC              = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (perf[p].state == CLOSE &amp;&amp; minP &gt; perf[p].P) {</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>                perf[p].state      = OPEN;</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>                perf[p].multiplier = 1;</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>            }</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>        }</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>            k = perf[p].location;</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>            <span class="keywordflow">if</span> (perf[p].state == OPEN &amp;&amp; myBulk.P[k] &gt; perf[p].P) {</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>                perf[p].state      = CLOSE;</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>                perf[p].multiplier = 0;</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>                flagC              = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (perf[p].state == CLOSE &amp;&amp; myBulk.P[k] &lt; perf[p].P) {</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>                perf[p].state      = OPEN;</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>                perf[p].multiplier = 1;</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>            }</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>        }</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>    }</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span> </div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>    <span class="keywordtype">bool</span> flag = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>    <span class="comment">// check well --  if all perf are closed, open the depthest perf</span></div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>        <span class="keywordflow">if</span> (perf[p].state == OPEN) {</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>            flag = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>        }</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>    }</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>    <span class="keywordflow">if</span> (!flag) {</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>        <span class="comment">// open the depthest perf</span></div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>        <span class="comment">/*perf.back().state = OPEN;</span></div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span><span class="comment">        perf.back().multiplier = 1;*/</span></div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>    }</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    <span class="keywordflow">if</span> (!flagC) {</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>        dG = ldG;</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>        <a class="code hl_function" href="classWell.html#a869e7fb570c02e1c9999576bcc12ba5e">CalTrans</a>(myBulk);</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>        <a class="code hl_function" href="classWell.html#a874b5ec76145d0c252c953d809c9de77">CalFlux</a>(myBulk);</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>        <a class="code hl_function" href="classWell.html#a98c5c54987ca460ab025504f014ce96e">CaldG</a>(myBulk);</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>        <a class="code hl_function" href="classWell.html#abf45c0fc2455e809a3505f327e1afcb7">SmoothdG</a>();</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>        <span class="comment">// CheckOptMode(myBulk);</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>        <span class="keywordflow">return</span> 3;</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>    }</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span> </div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>}</div>
<div class="ttc" id="aclassWell_html_a869e7fb570c02e1c9999576bcc12ba5e"><div class="ttname"><a href="classWell.html#a869e7fb570c02e1c9999576bcc12ba5e">Well::CalTrans</a></div><div class="ttdeci">void CalTrans(const Bulk &amp;myBulk)</div><div class="ttdoc">calculate transmissibility for each phase in perforations.</div><div class="ttdef"><b>Definition:</b> <a href="Well_8cpp_source.html#l00642">Well.cpp:642</a></div></div>
<div class="ttc" id="aclassWell_html_a874b5ec76145d0c252c953d809c9de77"><div class="ttname"><a href="classWell.html#a874b5ec76145d0c252c953d809c9de77">Well::CalFlux</a></div><div class="ttdeci">void CalFlux(const Bulk &amp;myBulk, const bool flag=false)</div><div class="ttdef"><b>Definition:</b> <a href="Well_8cpp_source.html#l00678">Well.cpp:678</a></div></div>
<div class="ttc" id="aclassWell_html_a98c5c54987ca460ab025504f014ce96e"><div class="ttname"><a href="classWell.html#a98c5c54987ca460ab025504f014ce96e">Well::CaldG</a></div><div class="ttdeci">void CaldG(const Bulk &amp;myBulk)</div><div class="ttdef"><b>Definition:</b> <a href="Well_8cpp_source.html#l00441">Well.cpp:441</a></div></div>
<div class="ttc" id="aclassWell_html_abf45c0fc2455e809a3505f327e1afcb7"><div class="ttname"><a href="classWell.html#abf45c0fc2455e809a3505f327e1afcb7">Well::SmoothdG</a></div><div class="ttdeci">void SmoothdG()</div><div class="ttdef"><b>Definition:</b> <a href="Well_8cpp_source.html#l00433">Well.cpp:433</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dcdd933eca7605282cc48f8a870eedb" name="a1dcdd933eca7605282cc48f8a870eedb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dcdd933eca7605282cc48f8a870eedb">&#9670;&nbsp;</a></span>CheckOptMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::CheckOptMode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >check if well operation mode would be changed. constant well pressure would be applied if flow rate is too large. constant flow rate would be applied if well pressure is outranged. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00858">858</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>{</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>    <span class="keywordflow">if</span> (opt.type == INJ) {</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classWell.html#ae3b9eb3c86378e65b9bad809946d2f4f">CalInjRate_Blk</a>(myBulk) &gt; opt.maxRate) {</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>            opt.optMode = RATE_MODE;</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>            opt.optMode = BHP_MODE;</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>        }</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classWell.html#a9d134cb63650ae6dc9ce0b00a370a796">CalProdRate_Blk</a>(myBulk) &gt; opt.maxRate) {</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>            opt.optMode = RATE_MODE;</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>            opt.optMode = BHP_MODE;</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>        }</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    }</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>}</div>
<div class="ttc" id="aclassWell_html_a9d134cb63650ae6dc9ce0b00a370a796"><div class="ttname"><a href="classWell.html#a9d134cb63650ae6dc9ce0b00a370a796">Well::CalProdRate_Blk</a></div><div class="ttdeci">OCP_DBL CalProdRate_Blk(const Bulk &amp;myBulk)</div><div class="ttdef"><b>Definition:</b> <a href="Well_8cpp_source.html#l00762">Well.cpp:762</a></div></div>
<div class="ttc" id="aclassWell_html_ae3b9eb3c86378e65b9bad809946d2f4f"><div class="ttname"><a href="classWell.html#ae3b9eb3c86378e65b9bad809946d2f4f">Well::CalInjRate_Blk</a></div><div class="ttdeci">OCP_DBL CalInjRate_Blk(const Bulk &amp;myBulk)</div><div class="ttdef"><b>Definition:</b> <a href="Well_8cpp_source.html#l00742">Well.cpp:742</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f1d44fd7586866a902cfc90e3538e8a" name="a2f1d44fd7586866a902cfc90e3538e8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f1d44fd7586866a902cfc90e3538e8a">&#9670;&nbsp;</a></span>CheckP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a> Well::CheckP </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check if abnormal Pressure occurs. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00875">875</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>{</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>    <span class="comment">// 0 : all correct</span></div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>    <span class="comment">// 1 : negative P</span></div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>    <span class="comment">// 2 : outlimited P</span></div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>    <span class="comment">// 3 : crossflow happens</span></div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span> </div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>    <span class="keywordflow">if</span> (BHP &lt; 0) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>        <span class="keywordflow">if</span> (perf[p].state == OPEN &amp;&amp; perf[p].P &lt; 0) {</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span><span class="preprocessor">#ifdef _DEBUG</span></div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>            cout &lt;&lt; <span class="stringliteral">&quot;WARNING: Well &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; Perf[&quot;</span> &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot;].P = &quot;</span> &lt;&lt; perf[p].P</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>                 &lt;&lt; endl;</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span><span class="preprocessor">#endif </span><span class="comment">// _DEBUG</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>        }</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>    }</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span> </div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>    <span class="keywordflow">if</span> (opt.type == INJ) {</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>        <span class="keywordflow">if</span> (opt.optMode != BHP_MODE &amp;&amp; BHP &gt; opt.maxBHP) {</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>            opt.optMode = BHP_MODE;</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>            <span class="keywordflow">return</span> 2;</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>        }</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>        <span class="keywordflow">if</span> (opt.optMode != BHP_MODE &amp;&amp; BHP &lt; opt.minBHP) {</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>            opt.optMode = BHP_MODE;</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>            <span class="keywordflow">return</span> 2;</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>        }</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>    }</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#ae1557888748310c9f05f88c69bb30cc3">OCP_INT</a> flag = 0;</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>    flag         = <a class="code hl_function" href="classWell.html#ab166b401ceae3c2290de9eb5f85c2c51">CheckCrossFlow</a>(myBulk);</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span> </div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    <span class="keywordflow">return</span> flag;</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>}</div>
<div class="ttc" id="aclassWell_html_ab166b401ceae3c2290de9eb5f85c2c51"><div class="ttname"><a href="classWell.html#ab166b401ceae3c2290de9eb5f85c2c51">Well::CheckCrossFlow</a></div><div class="ttdeci">OCP_INT CheckCrossFlow(const Bulk &amp;myBulk)</div><div class="ttdoc">check if crossflow happens.</div><div class="ttdef"><b>Definition:</b> <a href="Well_8cpp_source.html#l00910">Well.cpp:910</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a137e72feecbbb28b5a70515a85f7db5d" name="a137e72feecbbb28b5a70515a85f7db5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a137e72feecbbb28b5a70515a85f7db5d">&#9670;&nbsp;</a></span>Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::Init </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >guess the well pressure at the beginning of simulation. usually the pressure equals the ones in topest bulk which connects to the well. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00176">176</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>{ BHP = myBulk.P[perf[0].location]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a7325e7ccce6aed4f469e06d598066d" name="a6a7325e7ccce6aed4f469e06d598066d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a7325e7ccce6aed4f469e06d598066d">&#9670;&nbsp;</a></span>InputPerfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::InputPerfo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classWellParam.html">WellParam</a> &amp;&#160;</td>
          <td class="paramname"><em>well</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Input the param of perforations. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00070">70</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>{</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    numPerf = well.<a class="code hl_variable" href="classWellParam.html#ab119452e566772ff6f8471c6f1be06dd">I_perf</a>.size();</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    perf.resize(numPerf);</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        perf[p].I          = well.<a class="code hl_variable" href="classWellParam.html#ab119452e566772ff6f8471c6f1be06dd">I_perf</a>[p] - 1;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>        perf[p].J          = well.<a class="code hl_variable" href="classWellParam.html#abc0da124d89dc98dd657bea0e45b5c1c">J_perf</a>[p] - 1;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        perf[p].K          = well.<a class="code hl_variable" href="classWellParam.html#ac634948e8516ee00d89a5f6644654d5e">K_perf</a>[p] - 1;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        perf[p].WI         = well.<a class="code hl_variable" href="classWellParam.html#ab7060969e2b87291282f9e11b3942dcf">WI</a>[p];</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        perf[p].radius     = well.<a class="code hl_variable" href="classWellParam.html#a5ec4f1ee1812092a5e0c01832ab57660">diameter</a>[p] / 2.0;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>        perf[p].kh         = well.kh[p];</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        perf[p].skinFactor = well.<a class="code hl_variable" href="classWellParam.html#a8260948f9a4255d068f8b95c7b6b2191">skinFactor</a>[p];</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>        <span class="keywordflow">if</span> (well.<a class="code hl_variable" href="classWellParam.html#a161b69a0b54f11ebb716865d4f8ebcc5">direction</a>[p] == <span class="stringliteral">&quot;X&quot;</span> || well.<a class="code hl_variable" href="classWellParam.html#a161b69a0b54f11ebb716865d4f8ebcc5">direction</a>[p] == <span class="stringliteral">&quot;x&quot;</span>) {</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>            perf[p].direction = X_DIRECTION;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (well.<a class="code hl_variable" href="classWellParam.html#a161b69a0b54f11ebb716865d4f8ebcc5">direction</a>[p] == <span class="stringliteral">&quot;Y&quot;</span> || well.<a class="code hl_variable" href="classWellParam.html#a161b69a0b54f11ebb716865d4f8ebcc5">direction</a>[p] == <span class="stringliteral">&quot;y&quot;</span>) {</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>            perf[p].direction = Y_DIRECTION;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (well.<a class="code hl_variable" href="classWellParam.html#a161b69a0b54f11ebb716865d4f8ebcc5">direction</a>[p] == <span class="stringliteral">&quot;Z&quot;</span> || well.<a class="code hl_variable" href="classWellParam.html#a161b69a0b54f11ebb716865d4f8ebcc5">direction</a>[p] == <span class="stringliteral">&quot;z&quot;</span>) {</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>            perf[p].direction = Z_DIRECTION;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>            ERRORcheck(<span class="stringliteral">&quot;Wrong direction of perforations&quot;</span>);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>            exit(0);</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        }</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    }</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>}</div>
<div class="ttc" id="aclassWellParam_html_a161b69a0b54f11ebb716865d4f8ebcc5"><div class="ttname"><a href="classWellParam.html#a161b69a0b54f11ebb716865d4f8ebcc5">WellParam::direction</a></div><div class="ttdeci">vector&lt; string &gt; direction</div><div class="ttdoc">Direction of perforations.</div><div class="ttdef"><b>Definition:</b> <a href="ParamWell_8hpp_source.html#l00079">ParamWell.hpp:79</a></div></div>
<div class="ttc" id="aclassWellParam_html_a5ec4f1ee1812092a5e0c01832ab57660"><div class="ttname"><a href="classWellParam.html#a5ec4f1ee1812092a5e0c01832ab57660">WellParam::diameter</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; diameter</div><div class="ttdoc">Diameter of perforations.</div><div class="ttdef"><b>Definition:</b> <a href="ParamWell_8hpp_source.html#l00076">ParamWell.hpp:76</a></div></div>
<div class="ttc" id="aclassWellParam_html_a8260948f9a4255d068f8b95c7b6b2191"><div class="ttname"><a href="classWellParam.html#a8260948f9a4255d068f8b95c7b6b2191">WellParam::skinFactor</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; skinFactor</div><div class="ttdoc">Skin factor.</div><div class="ttdef"><b>Definition:</b> <a href="ParamWell_8hpp_source.html#l00078">ParamWell.hpp:78</a></div></div>
<div class="ttc" id="aclassWellParam_html_ab119452e566772ff6f8471c6f1be06dd"><div class="ttname"><a href="classWellParam.html#ab119452e566772ff6f8471c6f1be06dd">WellParam::I_perf</a></div><div class="ttdeci">vector&lt; USI &gt; I_perf</div><div class="ttdoc">I-index of perforation in grid.</div><div class="ttdef"><b>Definition:</b> <a href="ParamWell_8hpp_source.html#l00072">ParamWell.hpp:72</a></div></div>
<div class="ttc" id="aclassWellParam_html_ab7060969e2b87291282f9e11b3942dcf"><div class="ttname"><a href="classWellParam.html#ab7060969e2b87291282f9e11b3942dcf">WellParam::WI</a></div><div class="ttdeci">vector&lt; OCP_DBL &gt; WI</div><div class="ttdoc">Transmissiblity connection factor.</div><div class="ttdef"><b>Definition:</b> <a href="ParamWell_8hpp_source.html#l00075">ParamWell.hpp:75</a></div></div>
<div class="ttc" id="aclassWellParam_html_abc0da124d89dc98dd657bea0e45b5c1c"><div class="ttname"><a href="classWellParam.html#abc0da124d89dc98dd657bea0e45b5c1c">WellParam::J_perf</a></div><div class="ttdeci">vector&lt; USI &gt; J_perf</div><div class="ttdoc">J-index of perforation in grid.</div><div class="ttdef"><b>Definition:</b> <a href="ParamWell_8hpp_source.html#l00073">ParamWell.hpp:73</a></div></div>
<div class="ttc" id="aclassWellParam_html_ac634948e8516ee00d89a5f6644654d5e"><div class="ttname"><a href="classWellParam.html#ac634948e8516ee00d89a5f6644654d5e">WellParam::K_perf</a></div><div class="ttdeci">vector&lt; USI &gt; K_perf</div><div class="ttdoc">K-index of perforation in grid.</div><div class="ttdef"><b>Definition:</b> <a href="ParamWell_8hpp_source.html#l00074">ParamWell.hpp:74</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ParamWell_8hpp_source.html#l00076">WellParam::diameter</a>, <a class="el" href="ParamWell_8hpp_source.html#l00079">WellParam::direction</a>, <a class="el" href="ParamWell_8hpp_source.html#l00072">WellParam::I_perf</a>, <a class="el" href="ParamWell_8hpp_source.html#l00073">WellParam::J_perf</a>, <a class="el" href="ParamWell_8hpp_source.html#l00074">WellParam::K_perf</a>, <a class="el" href="ParamWell_8hpp_source.html#l00078">WellParam::skinFactor</a>, and <a class="el" href="ParamWell_8hpp_source.html#l00075">WellParam::WI</a>.</p>

</div>
</div>
<a id="a0654767d227788ef21edc111c4383710" name="a0654767d227788ef21edc111c4383710"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0654767d227788ef21edc111c4383710">&#9670;&nbsp;</a></span>MassConserve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::MassConserve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="OCPConst_8hpp.html#a2c355586809161c6f4c3a35ebfa7cb1f">OCP_DBL</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update moles of components in those bulks who connects to the well. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00730">730</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>{</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>    <a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> nc = myBulk.numCom;</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span> </div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> k = perf[p].location;</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> i = 0; i &lt; nc; i++) {</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>            myBulk.Ni[k * nc + i] -= perf[p].qi_lbmol[i] * dt;</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>        }</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>    }</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab883d41c3842854f9c2fb15919d9880b" name="ab883d41c3842854f9c2fb15919d9880b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab883d41c3842854f9c2fb15919d9880b">&#9670;&nbsp;</a></span>Setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::Setup </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classGrid.html">Grid</a> &amp;&#160;</td>
          <td class="paramname"><em>myGrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBulk.html">Bulk</a> &amp;&#160;</td>
          <td class="paramname"><em>myBulk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup the well, it will be called when <a class="el" href="classGrid.html">Grid</a> and <a class="el" href="classBulk.html">Bulk</a> finish setupping. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00095">95</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>{</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    <span class="comment">// zi</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <span class="keywordflow">if</span> (myBulk.blackOil) {</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; opt : optSet) {</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>            opt.zi.resize(myBulk.numCom, 0);</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>            <span class="keywordflow">if</span> (opt.type == INJ) {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>                <span class="comment">// INJ</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>                <span class="keywordflow">switch</span> (myBulk.PVTmode) {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>                    <span class="keywordflow">case</span> PHASE_W:</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>                    <span class="keywordflow">case</span> PHASE_OW:</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>                        opt.zi.back() = 1;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>                    <span class="keywordflow">case</span> PHASE_OGW:</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>                        <span class="keywordflow">if</span> (opt.fluidType == GAS)</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>                            opt.zi[1] = 1;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>                        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                            opt.zi[2] = 1;</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                        ERRORcheck(<span class="stringliteral">&quot;WRONG Blackoil type!&quot;</span>);</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>                        exit(0);</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                }</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>                <span class="comment">// PROD</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>                <span class="keywordflow">switch</span> (myBulk.PVTmode) {</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>                    <span class="keywordflow">case</span> PHASE_W:</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>                        opt.zi.back() = 1;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>                    <span class="keywordflow">case</span> PHASE_OW:</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>                        <span class="keywordflow">if</span> (opt.optMode == ORATE_MODE)</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>                            opt.zi[0] = 1;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>                        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>                            opt.zi[1] = 1;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>                    <span class="keywordflow">case</span> PHASE_OGW:</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                        <span class="keywordflow">if</span> (opt.optMode == ORATE_MODE)</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>                            opt.zi[0] = 1;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opt.optMode == GRATE_MODE)</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                            opt.zi[1] = 1;</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                            opt.zi[2] = 1;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                        ERRORcheck(<span class="stringliteral">&quot;WRONG Blackoil type!&quot;</span>);</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                        exit(0);</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>            }</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>        }</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (myBulk.comps) {</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        ERRORcheck(<span class="stringliteral">&quot;Wrong Mixture Type !&quot;</span>);</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>        exit(0);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    }</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    qi_lbmol.resize(myBulk.numCom);</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <span class="comment">// perf</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    dG.resize(numPerf, 0);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    ldG = dG;</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>        perf[p].state = OPEN;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>        <a class="code hl_typedef" href="OCPConst_8hpp.html#a9951229752a2a6a4f40b81a78fad737b">OCP_USI</a> Idg =</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>            perf[p].K * myGrid.nx * myGrid.ny + perf[p].J * myGrid.nx + perf[p].I;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>        <span class="keywordflow">if</span> (!myGrid.activeMap_G2B[Idg].GetAct()) {</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>            ERRORcheck(<span class="stringliteral">&quot;Perforation is in inactive bulk !&quot;</span>);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>            exit(0);</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>        }</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        perf[p].location   = myGrid.activeMap_G2B[Idg].GetId();</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        perf[p].depth      = myBulk.depth[perf[p].location];</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>        perf[p].multiplier = 1;</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>        perf[p].qi_lbmol.resize(myBulk.numCom);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        perf[p].transj.resize(myBulk.numPhase);</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    }</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    <span class="keywordflow">if</span> (depth &lt; 0) depth = perf[0].depth;</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span> </div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    <a class="code hl_function" href="classWell.html#a2e894e0c7d9960483db283add94d34f4">CalWI_Peaceman_Vertical</a>(myBulk);</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    cout &lt;&lt; <span class="stringliteral">&quot;Well::Setup&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>}</div>
<div class="ttc" id="aclassWell_html_a2e894e0c7d9960483db283add94d34f4"><div class="ttname"><a href="classWell.html#a2e894e0c7d9960483db283add94d34f4">Well::CalWI_Peaceman_Vertical</a></div><div class="ttdeci">void CalWI_Peaceman_Vertical(const Bulk &amp;myBulk)</div><div class="ttdoc">cal Well Index with Peaceman model for vertical well.</div><div class="ttdef"><b>Definition:</b> <a href="Well_8cpp_source.html#l00191">Well.cpp:191</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb515fe5c49dd0ef3ca54d97cd1cb56e" name="adb515fe5c49dd0ef3ca54d97cd1cb56e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb515fe5c49dd0ef3ca54d97cd1cb56e">&#9670;&nbsp;</a></span>ShowPerfStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::ShowPerfStatus </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Display operation mode of well and state of perforations. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00976">976</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>{</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>    cout &lt;&lt; <span class="stringliteral">&quot;----------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>    cout &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;:    &quot;</span> &lt;&lt; opt.optMode &lt;&lt; endl;</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>        cout &lt;&lt; <span class="stringliteral">&quot;Perf[&quot;</span> &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot;].State = &quot;</span> &lt;&lt; perf[p].state &lt;&lt; endl;</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>    }</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abf45c0fc2455e809a3505f327e1afcb7" name="abf45c0fc2455e809a3505f327e1afcb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf45c0fc2455e809a3505f327e1afcb7">&#9670;&nbsp;</a></span>SmoothdG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Well::SmoothdG </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >try to smooth the dG by average it with dG at last time step. it's just a test now to make dG more stable. </p>

<p class="definition">Definition at line <a class="el" href="Well_8cpp_source.html#l00433">433</a> of file <a class="el" href="Well_8cpp_source.html">Well.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>{</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) {</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>        dG[p] = (ldG[p] + dG[p]) / 2; <span class="comment">// seems better</span></div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>                                      <span class="comment">// dG[p] = ldG[p] + 0.618 * (dG[p] - ldG[p]);</span></div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    }</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0da4ab9b101dd38ab921f991273719d4" name="a0da4ab9b101dd38ab921f991273719d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0da4ab9b101dd38ab921f991273719d4">&#9670;&nbsp;</a></span>UpdatePerfP()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Well::UpdatePerfP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>update pressure in <a class="el" href="classPerforation.html" title="Perforation describe the connections between wells and bulks.">Perforation</a> after well pressure updates. </p>

<p class="definition">Definition at line <a class="el" href="Well_8hpp_source.html#l00152">152</a> of file <a class="el" href="Well_8hpp_source.html">Well.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    {</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> p = 0; p &lt; numPerf; p++) perf[p].P = BHP + dG[p];</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e109c1f8cb0ee115b10a557d7928e5d" name="a7e109c1f8cb0ee115b10a557d7928e5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e109c1f8cb0ee115b10a557d7928e5d">&#9670;&nbsp;</a></span>WellState()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Well::WellState </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return the state of the well, Open or Close. </p>

<p class="definition">Definition at line <a class="el" href="Well_8hpp_source.html#l00079">79</a> of file <a class="el" href="Well_8hpp_source.html">Well.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>{ <span class="keywordflow">return</span> opt.state; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adf196051a266a036aeafb34035cc80b9" name="adf196051a266a036aeafb34035cc80b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf196051a266a036aeafb34035cc80b9">&#9670;&nbsp;</a></span>WellType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="OCPConst_8hpp.html#a24bc11890ea853a38fd9d6b843633b1b">USI</a> Well::WellType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return the type of well, Inj or Prod. </p>

<p class="definition">Definition at line <a class="el" href="Well_8hpp_source.html#l00081">81</a> of file <a class="el" href="Well_8hpp_source.html">Well.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>{ <span class="keywordflow">return</span> opt.type; }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a00dd6dcb59ae0bb7520c7294ea5cc585" name="a00dd6dcb59ae0bb7520c7294ea5cc585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00dd6dcb59ae0bb7520c7294ea5cc585">&#9670;&nbsp;</a></span>WellGroup</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classWellGroup.html">WellGroup</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Well_8hpp_source.html#l00074">74</a> of file <a class="el" href="Well_8hpp_source.html">Well.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="Well_8hpp_source.html">Well.hpp</a></li>
<li><a class="el" href="Well_8cpp_source.html">Well.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
